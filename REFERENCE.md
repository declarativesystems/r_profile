# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

* [`r_profile::aws`](#r_profileaws): Configure AWS with puppet
* [`r_profile::base`](#r_profilebase): A generic 'baseleve' style class
* [`r_profile::cloud::azure`](#r_profilecloudazure): Manage the azure VMs using the passed-in hash
* [`r_profile::cloud::azure_platform`](#r_profilecloudazure_platform): Setup the dependencies for the puppetlabs/azure forge module
* [`r_profile::cloud::vsphere`](#r_profilecloudvsphere): The forge module uses some locally gems for Vsphere library in order to talk to the Vsphere API
* [`r_profile::database::mysql_server`](#r_profiledatabasemysql_server): Install the MySQL database server
* [`r_profile::dns_client`](#r_profiledns_client): Support for configuring the DNS client
* [`r_profile::environment_variable`](#r_profileenvironment_variable): Manage enivronment variables on windows and linux
* [`r_profile::file`](#r_profilefile): Support for managing files and directories.
* [`r_profile::fw::post`](#r_profilefwpost): 'post' rules for iptables
* [`r_profile::fw::pre`](#r_profilefwpre): 'pre' rules for iptables
* [`r_profile::host`](#r_profilehost): Mange the static lookup table for hostnames.
* [`r_profile::java`](#r_profilejava): Install Java (openjdk) using puppetlabs/java
* [`r_profile::jenkins`](#r_profilejenkins): Support for Jenkins CI
* [`r_profile::lb::haproxy`](#r_profilelbhaproxy): A haproxy based load-balancer
* [`r_profile::linux::apt`](#r_profilelinuxapt): Setup of apt package manager
* [`r_profile::linux::at`](#r_profilelinuxat): Setup the `at` scheduler
* [`r_profile::linux::auditd`](#r_profilelinuxauditd): Manage audit service and rules
* [`r_profile::linux::base`](#r_profilelinuxbase): A basic Linux 'baseline' class
* [`r_profile::linux::chronyd`](#r_profilelinuxchronyd): Chronyd (formerly NTPd) support for Linux.
* [`r_profile::linux::cron`](#r_profilelinuxcron): Restrict permissions on the `cron` scheduler
* [`r_profile::linux::cups`](#r_profilelinuxcups): Manage cups printers with Puppet
* [`r_profile::linux::firewalld`](#r_profilelinuxfirewalld): Manage firewalld using crayfishx-firewalld
* [`r_profile::linux::fix_sticky_permissions`](#r_profilelinuxfix_sticky_permissions): Scan the system for directories that should have the sticky bit set
* [`r_profile::linux::grub`](#r_profilelinuxgrub): Secure the Grub 1.x boot-loader (RHEL < 7)
* [`r_profile::linux::grub2`](#r_profilelinuxgrub2): Secure the grub2 bootloader for RHEL7+
* [`r_profile::linux::hostname`](#r_profilelinuxhostname): Set the hostname using systemd and optionally the system IP address
* [`r_profile::linux::inittab`](#r_profilelinuxinittab): Set the system supported runlevels
* [`r_profile::linux::iptables`](#r_profilelinuxiptables): Management of the IPtables Linux firewall
* [`r_profile::linux::kernel_devel`](#r_profilelinuxkernel_devel): Configure a system for kernel compilation
* [`r_profile::linux::limits`](#r_profilelinuxlimits): Manage Linux system limits using saz/limits
* [`r_profile::linux::logrotate`](#r_profilelinuxlogrotate): Setup log rotation on Linux:
* [`r_profile::linux::module_disable`](#r_profilelinuxmodule_disable): Disable kernel modules by breaking them in `/etc/modeprobe.d/disable.conf`
* [`r_profile::linux::mount`](#r_profilelinuxmount): Common mount good practices for RedHat
* [`r_profile::linux::package_manager`](#r_profilelinuxpackage_manager): Configure a linux package manager
* [`r_profile::linux::password_policy`](#r_profilelinuxpassword_policy): Manage several settings related to password quality, privilege, aging and algorithm selection
* [`r_profile::linux::postfix`](#r_profilelinuxpostfix): Configure postfix for local mail delivery
* [`r_profile::linux::puppet_agent`](#r_profilelinuxpuppet_agent): Manage the Puppet agent
* [`r_profile::linux::realmd`](#r_profilelinuxrealmd): manage realmd(SSSD)
* [`r_profile::linux::resolv_conf`](#r_profilelinuxresolv_conf): Manage `/etc/resolv.conf`
* [`r_profile::linux::rsyslog_client`](#r_profilelinuxrsyslog_client): Setup `rsyslog` client
* [`r_profile::linux::samba_server`](#r_profilelinuxsamba_server): WIP easy samba support
* [`r_profile::linux::selinux`](#r_profilelinuxselinux): Manage SELinux
* [`r_profile::linux::sendmail`](#r_profilelinuxsendmail): Configure (currently disable) the sendmail daemon
* [`r_profile::linux::ssh`](#r_profilelinuxssh): SSH support on linux using Augeas.
* [`r_profile::linux::sudo`](#r_profilelinuxsudo): Configure sudo for linux using Puppet
* [`r_profile::linux::sysconfig_init`](#r_profilelinuxsysconfig_init): Configure `/etc/sysconfig/init`
* [`r_profile::linux::sysctl`](#r_profilelinuxsysctl): Control sysctl values (kernel tuning) on Linux.
* [`r_profile::linux::system_users`](#r_profilelinuxsystem_users): Lockdown and restrict users across the system:
* [`r_profile::linux::systemd`](#r_profilelinuxsystemd): Systemd settings and support for Puppet
* [`r_profile::linux::tcpwrappers`](#r_profilelinuxtcpwrappers): Setup tcpwrappers
* [`r_profile::linux::umask`](#r_profilelinuxumask): set the umask to be used inside various scripts
* [`r_profile::linux::vim`](#r_profilelinuxvim): Setup a nice version of vim
* [`r_profile::linux::wheel`](#r_profilelinuxwheel): Configure the `wheel` group on Linux
* [`r_profile::linux::yum`](#r_profilelinuxyum): Common yum settings for RedHat
* [`r_profile::linux::yumrepo`](#r_profilelinuxyumrepo): Setup the system yum repos
* [`r_profile::lockdown::at`](#r_profilelockdownat): Restrict access to the `at` daemon
* [`r_profile::lockdown::group`](#r_profilelockdowngroup): Lockdown groups by removing them.
* [`r_profile::lockdown::package`](#r_profilelockdownpackage): Purge the passed-in packages from the system
* [`r_profile::lockdown::user`](#r_profilelockdownuser): Lockdown users by disabling their passwords and or shells.
* [`r_profile::monitor::nagios_monitored`](#r_profilemonitornagios_monitored): Configure nagios to monitor something
* [`r_profile::monitor::nagios_server`](#r_profilemonitornagios_server): Confifgure nagios server
* [`r_profile::motd`](#r_profilemotd): Simple MOTD support for POSIX and Windows.
* [`r_profile::mount`](#r_profilemount): Configure filesystem mounts using the puppet
* [`r_profile::nginx`](#r_profilenginx): Support for Nginx webserver
* [`r_profile::nodejs`](#r_profilenodejs): 
* [`r_profile::ntp`](#r_profilentp): NTP for Linux/unix based servers.
* [`r_profile::package`](#r_profilepackage): Install software using Puppet's built-in `package` resource.
* [`r_profile::puppet::master`](#r_profilepuppetmaster): Enable restarting the `pe-puppetserver` service if its systemd environment is changed
* [`r_profile::puppet::master::agent_installers`](#r_profilepuppetmasteragent_installers): Install Puppet Enterprise agents for all supported platforms
* [`r_profile::puppet::master::autosign`](#r_profilepuppetmasterautosign): Configure Puppet Enterprise to autosign client certificates
* [`r_profile::puppet::master::db_backup`](#r_profilepuppetmasterdb_backup): Install a cron job to backup the PE postgres server
* [`r_profile::puppet::master::git_server`](#r_profilepuppetmastergit_server): Enable a simple built-in Git Server for puppet
* [`r_profile::puppet::master::hiera5`](#r_profilepuppetmasterhiera5): Hiera v5 support
* [`r_profile::puppet::master::hiera_eyaml`](#r_profilepuppetmasterhiera_eyaml): Configure hiera-eyaml package and/or encryption keys
* [`r_profile::puppet::master::license`](#r_profilepuppetmasterlicense): Install a puppet license key onto the puppet Master.
* [`r_profile::puppet::master::proxy`](#r_profilepuppetmasterproxy): Enable a Puppet Enterprise Master to work with a proxy server
* [`r_profile::puppet::nr_agent`](#r_profilepuppetnr_agent): Install non-root puppet agent(s).
* [`r_profile::repo`](#r_profilerepo): Declare (instantiate) the required profile classes in a stage before `main`: `repo`. The reason for this class to exist is because it is not 
* [`r_profile::ruby`](#r_profileruby): Install a system-level ruby for customer applications to use
* [`r_profile::service`](#r_profileservice): Ensure services are managed by Puppet to a particular state
* [`r_profile::timezone`](#r_profiletimezone): Select the active system timezone (requires reboot)
* [`r_profile::user`](#r_profileuser): Support for creating users and groups
* [`r_profile::virtual::vagrant`](#r_profilevirtualvagrant): Support for managing VMs via Vagrant (experimental)
* [`r_profile::virtual::virtual_box`](#r_profilevirtualvirtual_box): Install Oracle VirtualBox
* [`r_profile::web_service::apache`](#r_profileweb_serviceapache): Install and configure Apache webserver
* [`r_profile::web_service::iis`](#r_profileweb_serviceiis): Install and configure IIS web server
* [`r_profile::web_service::tomcat`](#r_profileweb_servicetomcat): Install and configure tomcat application server
* [`r_profile::webapp::geoserver`](#r_profilewebappgeoserver): Support for install GeoServer - A server-side Java GIS
* [`r_profile::webapp::git_site`](#r_profilewebappgit_site): Deploy web site(s) from git
* [`r_profile::webapp::php_config`](#r_profilewebappphp_config): Write PHP configuration file settings
* [`r_profile::webapp::wordpress`](#r_profilewebappwordpress): Install wordpress CMS using `hunner-wordpress`
* [`r_profile::windows::base`](#r_profilewindowsbase): Basic 'baselevel' class for Windows
* [`r_profile::windows::chocolatey`](#r_profilewindowschocolatey): Setup chocolatey package manager on Windows
* [`r_profile::windows::domain_membership`](#r_profilewindowsdomain_membership): Join an Active Directory domain using Puppet
* [`r_profile::windows::firewall`](#r_profilewindowsfirewall): Manage the windows advanced firewall.
* [`r_profile::windows::notepad_plus_plus`](#r_profilewindowsnotepad_plus_plus): Install notepad++ on windows
* [`r_profile::windows::nsclient`](#r_profilewindowsnsclient): Configure the NSClient++ software on Windows
* [`r_profile::windows::ntp`](#r_profilewindowsntp): Setup NTP on windows
* [`r_profile::windows::powershell`](#r_profilewindowspowershell): Does nothing
* [`r_profile::windows::proxy`](#r_profilewindowsproxy): Set the windows system proxy using netsh
* [`r_profile::windows::puppet_agent`](#r_profilewindowspuppet_agent): Manage the Puppet agent on Windows
* [`r_profile::windows::registry`](#r_profilewindowsregistry): Manage Windows registry entries with Puppet
* [`r_profile::windows::rename_administrator`](#r_profilewindowsrename_administrator): Rename the `administrator` account.
* [`r_profile::windows::windows_feature`](#r_profilewindowswindows_feature): Install Windows Features using Puppet and reboot if required.

**Functions**

* [`r_profile::list_agent_platforms`](#r_profilelist_agent_platforms): 

## Classes

### r_profile::aws

Configure AWS with puppet

#### Parameters

The following parameters are available in the `r_profile::aws` class.

##### `aws_access_key_id`

Data type: `Any`

AWS credential (ID)

Default value: hiera("r_profile::aws::aws_secret_key_id")

##### `aws_secret_access_key`

Data type: `Any`

AWS credential (Secret)

Default value: hiera("r_profile::aws::aws_secret_access_key")

##### `ec2_instance`

Data type: `Any`

Hash of EC2 intances to manage

Default value: hiera("r_profile::aws::ec2_instance", {})

##### `ec2_instance_default`

Data type: `Any`

Hash of EC2 intance default settings

Default value: hiera("r_profile::aws::ec2_instance_default", {})

##### `ec2_securitygroup`

Data type: `Any`

Hash of EC2 securitygroups to manage

Default value: hiera("r_profile::aws::ec2_securitygroup", {})

##### `ec2_securitygroup_default`

Data type: `Any`

Hash of EC2 securitygroups default settings

Default value: hiera("r_profile::aws::ec2_securitygroup_default", {})

##### `elb_loadbalancer`

Data type: `Any`

Hash of ELB loadbalancer to manage

Default value: hiera("r_profile::aws::elb_loadbalancer", {})

##### `elb_loadbalancer_default`

Data type: `Any`

Hash of ELB loadbalancer default settings

Default value: hiera("r_profile::aws::elb_loadbalancer_default", {})

### r_profile::base

A generic 'baseleve' style class

### r_profile::cloud::azure

Manage the azure VMs using the passed-in hash

#### Parameters

The following parameters are available in the `r_profile::cloud::azure` class.

##### `azure_vm`

Data type: `Hash`

Hash of azure VMs to create

Default value: {}

##### `azure_vm_default`

Data type: `Hash`

Hash of default settings for azure VMs

Default value: {}

##### `install_puppet_windows_cmd`

Data type: `Optional[String]`

Command to run to install puppet on windows

Default value: `undef`

##### `install_puppet_linux_cmd`

Data type: `Optional[String]`

Command to run to install puppet on linux

Default value: `undef`

##### `puppet_master_fqdn`

Data type: `Optional[String]`

FQDN of Puppet master

Default value: `undef`

##### `challenge_password`

Data type: `Optional[String]`

Challenge password to use for autosigning

Default value: `undef`

### r_profile::cloud::azure_platform

The forge module uses a locally installed copy of the Azure library in order
to talk to the Azure Cloud.  There are presently two versions of this library:
* `azure` command via the Azure xplat-cli (older, written in nodejs)
* `az` command via Azure CLI 2.0 (newer, written in python)

v1.x of forge module uses the xplat-cli and that is what this profile sets up
for you.

puppet module install puppet-nodejs --version 2.3.0

* **See also**
https://github.com/Azure/azure-xplat-cli

#### Parameters

The following parameters are available in the `r_profile::cloud::azure_platform` class.

##### `subscriptions`

Data type: `Hash`

Hash of subscriptions with the format:
```
  subscription_name = {
    subscription_id           => "the_subscription_id",
    tenant_id                 => "the_tenant_id",
    client_id                 => "the_client_id",
    client_secret             => "the_client_secret",
    user                      => "local linux user to run as",
    homedir                   => "home dir to install puppet agent",
    puppet_master_fqdn        => "fqdn.of.puppetmaster",
    run_puppet_ssh_public_key => "your public key...",
  }
```
* subscription_id The subsciption ID to provision ID to work with,
  obtainedfrom billing page in azure portal
* tenant_id The active directory tennant ID to work with, see
  https://stackoverflow.com/a/41028320/3441106
* client_id This is the equivalent of a username and involves registering
  an application in the Azure AD instance.  Once registered, the field to use
  here is `application_id`.  We don't use `object_id` at all.  Important:
  Once the user has been created, it needs to be given RBAC access to the
  Azure API which is done through the billing -> subscriptions menu
  @see https://docs.bmc.com/docs/cloudlifecyclemanagement/46/setting-up-a-tenant-id-client-id-and-client-secret-for-azure-resource-manager-provisioning-669202145.html
* client_secret This is the equivalent of a password for the above user
  and can be found by following the above tutorial
* user local user who will run this puppet agent
* homedir of this user (guess at /home/$user if absent)
* puppet_master_fqdn Address of puppet master to connect this agent to
* run_puppet_ssh_public_key If present, configure SSH to allow connections
  using this key to run the puppet agent -t command automatically

Default value: {}

##### `azure_gem_version`

Data type: `String`

Specify the version of the `azure` gem to use to talk
to the azure API - useful if you need to use a newer version of the
`puppetlabs-azure` module

Default value: "0.7.9"

##### `azure_mgmt_gem_version`

Data type: `String`

Specify the version of the `azure-mgmt-*` gems to
use to talk to the azure API - useful if you need to use a newer version of
the `puppetlabs-azure` module

Default value: "0.3.1"

##### `run_puppet_command`

Data type: `String`

How to run puppet agent (only this command will be allowed
via SSH)

Default value: "/opt/puppetlabs/puppet/bin/puppet agent -t"

### r_profile::cloud::vsphere

The forge module uses some locally gems for Vsphere library in order
to talk to the Vsphere API

#### Parameters

The following parameters are available in the `r_profile::cloud::vsphere` class.

##### `vsphere_host`

Data type: `Optional[String]`

hostname or IP address of vsphere server to talk to API as

Default value: `undef`

##### `vsphere_user`

Data type: `Optional[String]`

username for API

Default value: `undef`

##### `vsphere_password`

Data type: `Optional[String]`

password for API

Default value: `undef`

##### `vsphere_vm`

Data type: `Hash`

Hash of VMs to create

Default value: {}

##### `vsphere_vm_default`

Data type: `Hash`

Hash of default settings for creating VMs

Default value: {}

### r_profile::database::mysql_server

Install the MySQL database server

* **See also**
https://forge.puppet.com/puppetlabs/mysql

#### Examples

##### Basic usage

```puppet
include r_profile::database::mysql_server
```

##### Server settings

```puppet
r_profile::database::mysql_server::settings:
  root_password: "TopSecr3t"
  remove_default_accounts: true
```

##### Database creation

```puppet
r_profile::database::mysql_server::dbs:
  'mydb':
    user: 'myuser'
    password: 'mypass'
    host: 'localhost'
    grant:
      - 'SELECT'
      - 'UPDATE'
```

#### Parameters

The following parameters are available in the `r_profile::database::mysql_server` class.

##### `settings`

Data type: `Hash[String, Any]`

Hash of server settings to enforce (see examples)

Default value: {}

##### `dbs`

Data type: `Hash[String, Hash[String, Any]]`

Hash of databases to create (see examples)

Default value: {}

### r_profile::dns_client

Manges (/etc/resolve.conf) and the Name
Service Switch (/etc/nsswitch.conf and friends)

* **See also**
https://forge.puppet.com/geoffwilliams/resolv_conf/readme
https://forge.puppet.com/geoffwilliams/name_service_switch/readme

#### Parameters

The following parameters are available in the `r_profile::dns_client` class.

##### `search`

Data type: `Any`

Domain to attempt resolution of short hostsnames in first

Default value: hiera("r_profile::dns_client::search", undef)

##### `nameservers`

Data type: `Any`

Array of nameservers to use

Default value: hiera("r_profile::dns_client::nameservers", undef)

##### `options`

Data type: `Any`

Options Array of options to use

Default value: hiera("r_profile::dns_client::options", undef)

##### `nss_entries`

Data type: `Any`

Hash of settings to add to the nsswitch.conf file

Default value: hiera("r_profile::dns_client::nss_entries", undef)

##### `install_defaults`

Data type: `Any`

True to install module default DNS/NSS settings if
nothing found in hiera, otherwise dont' reconfigure dns

Default value: hiera("r_profile::dns_client::install_defaults", false)

### r_profile::environment_variable

Manage enivronment variables on windows and linux

* **See also**
https://forge.puppet.com/geoffwilliams/environment_variable

#### Examples

##### Basic usage

```puppet
include r_profile::environment_variable
```

##### Setting variables

```puppet
r_profile::environment_variable::variables:
  - "JAVA_HOME=/usr/local/jdk"
  - "JAVA_OPTS='-Djava.awt.headless=true'"
```

#### Parameters

The following parameters are available in the `r_profile::environment_variable` class.

##### `variables`

Data type: `Array[String]`

Array of variables to set in the form `variable=value` (see example)

Default value: []

### r_profile::file

Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.

#### Parameters

The following parameters are available in the `r_profile::file` class.

##### `base_files`

Data type: `Hash[String, Hash[String,Any]]`

Hash of files to create (suitable for `file` resource)

Default value: {}

##### `files`

Data type: `Hash[String, Hash[String,Any]]`

Hash of files to create (suitable for `file` resource)

Default value: {}

### r_profile::fw::post

'post' rules for iptables

### r_profile::fw::pre

'pre' rules for iptables

### r_profile::host

We take both a `base` and override hash of services and merge them to form a final list. This allows for simpler
management through hiera.

#### Examples

##### Basic usage

```puppet
include r_profile::host
```

##### Purging unmanaged entries

```puppet
r_profile::host::purge: true
```

##### Adding a host record

```puppet
r_profile::host::hosts:
  localhost.localdomain
    ip: 127.0.0.1
    host_aliases: localhost
```

#### Parameters

The following parameters are available in the `r_profile::host` class.

##### `base_hosts`

Data type: `Hash[String,Hash]`

Base hash of hosts to create, see examples

Default value: {}

##### `hosts`

Data type: `Hash[String,Hash]`

Override hash of hosts to create, see examples

Default value: {}

##### `purge`

Data type: `Boolean`

`true` to purge unmanaged host entries, otherwise `false`

Default value: `false`

### r_profile::java

Install Java (openjdk) using puppetlabs/java

#### Parameters

The following parameters are available in the `r_profile::java` class.

##### `version`

Data type: `Any`

Version of OpenJDK to install or undef to install latest

Default value: hiera('r_profile::java::version', undef)

### r_profile::jenkins

Support for Jenkins CI

### r_profile::lb::haproxy

https://tickets.puppetlabs.com/browse/MODULES-3932

#### Parameters

The following parameters are available in the `r_profile::lb::haproxy` class.

##### `listeners`

Data type: `Hash[String, Hash[String, Any]]`

Hash of listeners to create

Default value: {}

##### `frontends`

Data type: `Hash[String, Hash[String, Any]]`

Hash of frontends to create

Default value: {}

##### `backends`

Data type: `Hash[String, Hash[String, Any]]`

Hash of backends to create

Default value: {}

##### `admin_stats`

Data type: `Boolean`

`true` to enable the built-in stats web page

Default value: `false`

##### `stats_port`

Data type: `Array[Integer]`

TCP Port to run stats on

Default value: [9090]

##### `stats_username`

Data type: `String`

Username for stats website

Default value: "puppet"

##### `stats_password`

Data type: `String`

Password for stats website

Default value: "puppet"

### r_profile::linux::apt

Setup of apt package manager

* **See also**
https://forge.puppet.com/puppetlabs/apt

### r_profile::linux::at

Features:
* Remove `at.deny` so that only allowed users can run `at`
* Strict permissions on `at.allow`
* Allow `root` to use `at`

* **See also**
https://forge.puppet.com/puppetlabs/stdlib

### r_profile::linux::auditd

Manage audit service and rules

* **See also**
https://forge.puppet.com/geoffwilliams/auditd

#### Examples

##### Puppet usage

```puppet
include r_profile::linux::auditd
```

##### Hiera data for general auditd settings

```puppet
r_profile::linux::auditd::settings:
  log_format: "ENHANCED"
  max_log_file: 10
  num_logs: 5
  max_log_file_action: "rotate"
```

##### Hiera data to manage rules

```puppet

```

#### Parameters

The following parameters are available in the `r_profile::linux::auditd` class.

##### `rules`

Data type: `Hash[String, Hash[String,String]]`

Hash of rules to enforce (see examples)

Default value: {}

##### `settings`

Data type: `Hash[String, String]`

Hash or settings to apply to auditd (see examples)

Default value: {}

##### `audispd_settings`

Data type: `Hash[String, String]`

Hash of settings for the audispd.conf config file

Default value: {}

### r_profile::linux::base

A basic Linux 'baseline' class

### r_profile::linux::chronyd

the shared kernel makes this uncessary.

* **Note** No attempt is made to manage this service when running under docker since

#### Examples

##### Setup cronyd with the default list of servers

```puppet
include r_profile::linux::chronyd
```

##### Hiera data to list of particular servers

```puppet
r_profile::linux::chronyd::servers:
  - '0.au.pool.ntp.org'
  - '1.au.pool.ntp.org'
```

#### Parameters

The following parameters are available in the `r_profile::linux::chronyd` class.

##### `servers`

Data type: `Array[String]`

List of NTP servers to use

Default value: ["pool.ntp.org"]

### r_profile::linux::cron

Features:
* Remove `cron.deny` so that only allowed users can run `cron`
* Strict permissions on `at.allow`
* Allow `root` to use `cron`
* All files under `/var/spool/cron` owned by `root` with `0600` permissions (`crontab -e` will relax these)

* **See also**
https://forge.puppet.com/geoffwilliams/chown_r
https://forge.puppet.com/geoffwilliams/chmod_r
https://forge.puppet.com/puppetlabs/stdlib

### r_profile::linux::cups

Manage cups printers with Puppet

#### Parameters

The following parameters are available in the `r_profile::linux::cups` class.

##### `printer`

Data type: `Any`

Hash of printers in a form suitable for create_resources

Default value: hiera('r_profile::linux::cups::printer', {})

### r_profile::linux::firewalld

Accepts base plus additional options for each set of rule resources being
managed for easy managment using hiera.

* **See also**
https://forge.puppet.com/crayfishx/firewalld

#### Examples

##### hiera data for enabling free access to a service

```puppet
r_profile::linux::firewalld::firewalld_service:
  "allow ssh":
    ensure: present
    service: ssh
    zone: public
  "allow puppetmaster":
    ensure: present
    service: "puppetmaster"
    zone: public
  "allow puppet orchestrator":
    ensure:  present
    service: "puppet-orchestrator"
    zone: public
  "allow https":
    ensure: present
    service: "https"
    zone: public
```

##### hiera data for creating a rich rule

```puppet
r_profile::linux::firewalld::firewalld_rich_rule:{}
  'allow access to tomcat from internal':
    ensure: present
    zone: public
    action: accept
    source: '192.168.1.0/24'
    port:
      port: 8080
      protocol: tcp
```

##### Define additional custom service

```puppet
r_profile::linux::firewalld::custom_service:
  other_https:
    short: 'other_https',
    description: 'other_https',
    port:
      -
        port: 8443
        protocol: tcp
```

##### disable firewalld

```puppet
r_profile::linux::firewalld::service_ensure: stopped
r_profile::linux::firewalld::service_enable: false
```

#### Parameters

The following parameters are available in the `r_profile::linux::firewalld` class.

##### `service_ensure`

Data type: `Enum['running', 'stopped']`

How to ensure the `firewalld` service

Default value: 'running'

##### `service_enable`

Data type: `Boolean`

`true` to start firewalld on boot otherwise `false` to disable it

Default value: `true`

##### `base_firewalld_service`

Data type: `Hash[String, Optional[Hash]]`

base level `firewalld_service` rules (see examples)

Default value: {}

##### `firewalld_service`

Data type: `Hash[String, Optional[Hash]]`

additional `firewalld_service` rules (see examples)

Default value: {}

##### `base_firewalld_rich_rule`

Data type: `Hash[String, Optional[Hash]]`

base level `firewalld_rich_rule` rules (see examples)

Default value: {}

##### `firewalld_rich_rule`

Data type: `Hash[String, Optional[Hash]]`

additional `firewalld_rich_rule` rules (see examples)

Default value: {}

##### `base_custom_service`

Data type: `Hash[String, Optional[Hash]]`

Base level `firewalld::custom_service` definitions (see examples)

Default value: {}

##### `custom_service`

Data type: `Hash[String, Optional[Hash]]`

additional `firewalld::custom_service` definitions (see examples)

Default value: {}

### r_profile::linux::fix_sticky_permissions

Perform a system-wide find across local filesystems for world-writable
directories and make sure that they all have the sticky bit set so that only
the owning UID can delete them

WARNING! This class will perform a system-wide find every puppet run!  On a
modest VM with a 10gb filesystem, this takes approximately 30 seconds, however
it may much longer if you are running on a system with lots of local disk
available

### r_profile::linux::grub

Features:
* Permisisons on /etc/grub.conf
* remove any kernel commandline disabling selinux
* force all kernels to boot with audit=1
* optionally set a grub password

#### Parameters

The following parameters are available in the `r_profile::linux::grub` class.

##### `password_hash`

Data type: `Any`

md5 password hash for grub to use, generated by grub-md5-crypt

Default value: `false`

##### `mode`

Data type: `Any`

File mode for grub config file

Default value: "0600"

### r_profile::linux::grub2

Features:
  * Permissions on main config file
  * Bootloader passwords set for physical nodes

#### Examples

##### Hiera data with encrypted bootloader passwords

```puppet
r_profile::linux::grub2::bootloader_users:
  admin: "grub.pbkdf2.sha512.10000.D6956EF5CB5A4A4C67D72332F71FD62E8AC5FBF45723D2F658B846E554D031D3B56325CDFAF1854B\
    C6F98B0967023236B99C1B23BD058F47AD3C2891EBA03D35.91DD3B5338F287A8CCE20D665E0003F379C65724FE6833AE7B1CD1C0EB42A4\
    F9A03393F2C74F7D003E7A178DC475DBFD0FD501370DA60B4734BDF20872B2D314"
```

#### Parameters

The following parameters are available in the `r_profile::linux::grub2` class.

##### `bootloader_users`

Data type: `Variant[Boolean, Hash[String,String]]`

Hash of username -> encrypted password to use for
bootloader access on physical machines. Hashed passwords are generated using
the `grub2-mkpasswd-pbkdf2` tool. Plaintext passwords are not allowed. To
disable password protection, pass `false` here instead

Default value: {}

### r_profile::linux::hostname

By default, set the hostname to match `certname` - the name of the signed
certificate that puppet knows about.  This is useful for cloud environments
such as azure that assign dnsdomains based on regions that cannot be changed
to a sensible default

#### Examples

##### Set the hostname based on the puppet `certname`

```puppet
include r_profile::linux::hostname
```

#### Parameters

The following parameters are available in the `r_profile::linux::hostname` class.

##### `fqdn`

Data type: `String`

The fully qualified hostname that this host should use for all names

Default value: hiera("r_profile::linux::hostname::fqdn", $trusted['certname'])

##### `ip`

Data type: `Optional[String]`

The IP address of a corresponding entry to add to /etc/hosts if required

Default value: hiera("r_profile::linux::hostname::ip", undef)

### r_profile::linux::inittab

Set the system supported runlevels

#### Parameters

The following parameters are available in the `r_profile::linux::inittab` class.

##### `runlevels`

Data type: `String`

String containing allowed runlevels

Default value: "3"

### r_profile::linux::iptables

Management of the IPtables Linux firewall

#### Parameters

The following parameters are available in the `r_profile::linux::iptables` class.

##### `ensure`

Data type: `Enum['managed', 'disabled', 'unmanaged']`

`managed` take control of the IPtables firewall, `disabled` turn
IPtables off, `unmanaged` do not change firewall settings

Default value: 'unmanaged'

### r_profile::linux::kernel_devel

Currently suported:
* RedHat

### r_profile::linux::limits

Manage Linux system limits using saz/limits

* **See also**
https://forge.puppet.com/saz/limits/

#### Examples

##### hiera data to enable purging unmanaged rules

```puppet
r_profile::linux::limits::purge: true
```

##### hiera data to set limits

```puppet
r_profile::linux::limits::settings:
  '*/nofile':
    hard: 1048576
    soft: 1048576
  '*/memlock':
    both: unlimited
```

#### Parameters

The following parameters are available in the `r_profile::linux::limits` class.

##### `purge`

Data type: `Boolean`

True to remove unmanaged entries otherwise false

Default value: `false`

##### `settings`

Data type: `Hash`

Hash of limits settings to make

Default value: {}

### r_profile::linux::logrotate

Features:
  * installation/configuration of logrotate
  * rotation defaults
  * individual rules

* **See also**
https://forge.puppet.com/geoffwilliams/logrotate

#### Examples

##### class usage

```puppet
include r_profile::linux::logrotate
```

##### Hiera data to set default rotation options:

```puppet
r_profile::linux::logrotate::settings:
  rotate: 10
  weekly:
  create:
  dateext:
```

##### Hiera data to set log rotation entries

```puppet
r_profile::linux::logrotate::entries:
  /var/log/httpd/*.log':
    settings:
      rotate: 5
      mail: 'test@example.com'
      size: '100k'
      sharedscripts:
      postrotate: '/etc/init.d/httpd restart'
```

#### Parameters

The following parameters are available in the `r_profile::linux::logrotate` class.

##### `entries`

Data type: `Hash[String, Optional[Hash]]`

Hash of logrotate entries to create (see examples)

Default value: {}

##### `settings`

Data type: `Hash[String, Any]`

Hash of default settings for `logrotate.conf` (see examples)

Default value: {}

### r_profile::linux::module_disable

Kernel modules will be disabled rather than blacklisted by this process as `modprobe` will try to load the related
file. Since we definie the module as `/bin/true`, it wonâ€™t be loaded.

* **See also**
https://forge.puppet.com/puppetlabs/stdlib
https://linux-audit.com/kernel-hardening-disable-and-blacklist-linux-modules/

#### Parameters

The following parameters are available in the `r_profile::linux::module_disable` class.

##### `modules`

Data type: `Array[String]`

Disable these kernel modules from loading

Default value: []

##### `disable_file`

Data type: `String`

File to store the module blacklist in

Default value: "/etc/modprobe.d/disabled.conf"

### r_profile::linux::mount

Features:
  * `/tmp` mounted `nodev,nosuid,noexec` (if separate partition)
  * `/dev/shm` mounted `nodev,nosuid,noexec` (if separate partition)
  * Optionally bind mount `/var/tmp` to `/tmp`
  * All partitions except `/` mounted with `nodev` option

Note that options for `/dev/shm` will be ignored as per https://bugzilla.redhat.com/show_bug.cgi?id=783884

Puppet provides a `mountpoint` fact with output similar to:
  /home => {
    available => "19.97 GiB",
    available_bytes => 21438976000,
    capacity => "0.16%",
    device => "/dev/mapper/centos-home",
    filesystem => "xfs",
    options => [
      "rw",
      "seclabel",
      "relatime",
      "attr2",
      "inode64",
      "noquota"
    ],
    size => "20.00 GiB",
    size_bytes => 21472735232,
    used => "32.20 MiB",
    used_bytes => 33759232
  },

This is completely different to the input the `mount` provider uses:
  mount { '/home':
    ensure  => 'mounted',
    device  => '/dev/mapper/centos-home',
    dump    => '0',
    fstype  => 'xfs',
    options => 'defaults',
    pass    => '0',
    target  => '/etc/fstab',
  }

Since the `mountpoint` fact does not include the current ensure, this profile uses a new
fact `fstab` which includes the content of `/etc/fstab` validated against `/proc/mounts` and
excluding any swap partitions:
  /home => {
    ensure => "mounted",
    device => "/dev/mapper/centos-home",
    fstab => "xfs",
    options => "defaults",
    dump => "0",
    pass => "0"
  }

* **See also**
https://puppet.com/docs/puppet/5.5/types/mount.html

#### Examples

##### hiera data to enable bind mounting /tmp

```puppet
r_profile::linux::mount::bind_mount_var_tmp: true
```

#### Parameters

The following parameters are available in the `r_profile::linux::mount` class.

##### `bind_mount_var_tmp`

Data type: `Boolean`

`true` to bind mount `/var/tmp` onto `/tmp` if
`/var/tmp` is not _already_ a separately mounted partition

Default value: `false`

### r_profile::linux::package_manager

Configure a linux package manager

### r_profile::linux::password_policy

Enforce aging settings (`/etc/login.defs`):
  * password max days
  * password warn age
  * password algorithm

Enforce password quality (`/etc/security/pwquality.conf`):
  * All directives passed in `password_quality` parameter

Pam (`/etc/pam.d/system-auth` and `/etc/pam.d/su`):
  * Tell pam to remember old passwords to prevent reuse
  * Tell pam to enforce password quality
  * Restrict `su` command to members of group `wheel`

Pam (`/etc/pam.d/password-auth` and `/etc/pam.d/system-auth`):
  * Lock accounts after 3 incorrect login attempts

* **See also**
https://forge.puppet.com/herculesteam/augeasproviders_core
https://forge.puppet.com/herculesteam/augeasproviders_pamv
https://forge.puppet.com/puppetlabs/stdlib

#### Examples

##### Hiera data for password quality

```puppet
r_profile::linux::password_policy::password_quality:
  minlen: 10
  dcredit: -1
  ucredit: -1
  ocredit: -1
  lcredit: -1

The key names map to the available directives in the file. In this case, password must:
* be 10 characters or more
* contain provide at least 1 digit
* contain at least one uppercase character
* contain at least one special character
* contain at least one lowercase character
```

#### Parameters

The following parameters are available in the `r_profile::linux::password_policy` class.

##### `pass_max_days`

Data type: `Integer`

maximum age of a password

Default value: 90

##### `pass_warn_age`

Data type: `Integer`

how long to warn before password expires

Default value: 7

##### `password_algorithm`

Data type: `String`

password algorithm to use

Default value: "sha512"

##### `saved_passwords`

Data type: `Integer`

how many old passwords to remember?

Default value: 4

##### `manage_authconfig`

Data type: `Boolean`

True to install `authconfig`, otherwise assume its
already on the system. `authconfig` command is required inspect the password
settings that apply on this system

Default value: `true`

##### `password_quality`

Data type: `Hash[String,Integer]`

Hash of settings to enforce in /etc/security/pwquality.conf

Default value: {}

### r_profile::linux::postfix

Configure postfix for local mail delivery

#### Parameters

The following parameters are available in the `r_profile::linux::postfix` class.

##### `inet_interfaces`

Data type: `Any`

network interfaces to listen on, becomes inet_interfaces in
the main.cf file

Default value: "localhost"

### r_profile::linux::puppet_agent

Manages:
  * Puppet Agent service
  * Proxy server environment variable support

The Puppet Agent is not managed by Puppet Enterprise out of the box (but PXP Agent is...). To restart them using
Puppet we create service resources for them here so that restarts can be carried out as necessary.

To support proxy servers, we set the `http_proxy` and `https_proxy` environment variables for both agents. Scheduled
Puppet agent runs will use the defaults from `sysconf_puppet`, Puppet agent initiated by PXP (run puppet button) uses
`sysconf_pxp_agent`. By setting the environment in both files, consistency can be reached, apart from when running
directly on the command line with `puppet agent -t`. In this case, the operator is resposonsible for its own
environment

* **See also**
https://forge.puppet.com/puppetlabs/stdlib

#### Parameters

The following parameters are available in the `r_profile::linux::puppet_agent` class.

##### `proxy`

Data type: `Variant[String, Boolean]`

`false` to skip configuration of a proxy server, otherwise the proxy server url, eg
`http://proxy.megacorp.com:8080`

Default value: `false`

##### `sysconf_puppet`

Data type: `String`

Path to sysconf file for puppet agent. Used to set proxy server environment variables

Default value: "${facts['sysconf_dir']}/puppet"

##### `sysconf_pxp_agent`

Data type: `String`

Path to sysconf file for pxp agent. Used to set proxy server environment variables

Default value: "${facts['sysconf_dir']}/pxp-agent"

##### `puppet_agent_service`

Data type: `String`

Name of the Puppet Agent service to manage

Default value: "puppet"

##### `puppet_agent_enable`

Data type: `Boolean`

`true` to start Puppet Agent on boot, otherwise `false`

Default value: `true`

##### `puppet_agent_ensure`

Data type: `Enum['running', 'stopped']`

How to ensure the Puppet Agent service

Default value: 'running'

##### `pxp_agent_service`

Data type: `String`

Name of the PXP Agent service to manage

Default value: "pxp-agent"

### r_profile::linux::realmd

Support for setting up realmd (SSSD) for authentication against a directory server on
RHEL 7. You are advised to use hiera-eyaml to encrypt the `ad_password` parameter when
using this profile.

To avoid catalogue compilation failure when required AD details are missing, the module
will only attempt to configure AD support when the following are present:
  * domain
  * ad_username
  * ad_password
  * ou

* **See also**
https://forge.puppet.com/geoffwilliams/realmd

#### Examples

##### activating the realmd profile

```puppet
include r_profile::linux::realmd
```

##### Hiera data for joining domain

```puppet
r_profile::linux::realmd::domain: "megacorp.com"
r_profile::linux::realmd::ad_username: "ad_join"
r_profile::linux::realmd::ad_password: "topsecret" # plaintext password not recommended
r_profile::linux::realmd::ou:
  - 'linux'
  - 'servers'
r_profile::linux::realmd::groups:
  - 'admins'
  - 'superadmins'
```

##### Hiera data with encrypted password

```puppet
r_profile::linux::realmd::ad_password: >
  ENC[PKCS7,Y22exl+OvjDe+drmik2XEeD3VQtl1uZJXFFF2NnrMXDWx0csyqLB/2NOWefv
  NBTZfOlPvMlAesyr4bUY4I5XeVbVk38XKxeriH69EFAD4CahIZlC8lkE/uDh
  jJGQfh052eonkungHIcuGKY/5sEbbZl/qufjAtp/ufor15VBJtsXt17tXP4y
  l5ZP119Fwq8xiREGOL0lVvFYJz2hZc1ppPCNG5lwuLnTekXN/OazNYpf4CMd
  /HjZFXwcXRtTlzewJLc+/gox2IfByQRhsI/AgogRfYQKocZgFb/DOZoXR7wm
  IZGeunzwhqfmEtGiqpvJJQ5wVRdzJVpTnANBA5qxeA==]
```

#### Parameters

The following parameters are available in the `r_profile::linux::realmd` class.

##### `domain`

Data type: `Optional[String]`

Domain to join

Default value: `undef`

##### `ad_username`

Data type: `Optional[String]`

AD username to use for joining

Default value: `undef`

##### `ad_password`

Data type: `Optional[String]`

AD password to use for joining

Default value: `undef`

##### `ou`

Data type: `Optional[Array[String]]`

Array of OUs to use for joining eg `foo,bar,baz` (OU= will be added for you)

Default value: `undef`

##### `groups`

Data type: `Optional[Array[String]]`

List of groups to add to `simple_allow_groups` (will be flattened for you)

Default value: `undef`

### r_profile::linux::resolv_conf

Manage `/etc/resolv.conf`

* **See also**
https://forge.puppet.com/geoffwilliams/resolv_conf

#### Examples

##### basic usage

```puppet
include r_profile::linux::resolv_conf
```

##### Hiera data

```puppet
r_profile::linux::resolv_conf::settings:
  search: "megalan megacorp.com",
  nameservers:
    - "10.0.0.1"
    - "10.0.4.4"
```

#### Parameters

The following parameters are available in the `r_profile::linux::resolv_conf` class.

##### `base_settings`

Data type: `Hash[String, Variant[String, Array[String]]]`

Base hash of settings to pass to `resolv_conf` class (see examples)

Default value: {}

##### `settings`

Data type: `Hash[String, Variant[String, Array[String]]]`

Override hash of settings to pass to `resolv_conf` class (see examples)

Default value: {}

### r_profile::linux::rsyslog_client

Features:
  * Install Package
  * General settings
  * Managed logfiles

* **See also**
https://forge.puppet.com/geoffwilliams/rsyslog_client

#### Examples

##### Setup syslog client with settings from hiera

```puppet
include r_profile::linux::rsyslog
```

##### Hiera data for general rsyslog settings

```puppet
r_profile::linux::rsyslog_client::settings:
  - '$FileOwner': 'root'
  - '$FileGroup': 'root'
  - '$FileCreateMode': '0600'
  - '$DirOwner': 'root'
  - '$DirGroup': 'root'
  - '$DirCreateMode': '0750'
```

##### Hiera data for rsyslog entries

```puppet
r_profile::linux::rsyslog_client::entries:
  'daemon.*': /var/log/daemon.log
  'syslog.*': /var/log/syslog
```

#### Parameters

The following parameters are available in the `r_profile::linux::rsyslog_client` class.

##### `settings`

Data type: `Array[Hash[String, Any]]`

Settings to insert into the `rsyslog.conf` file. Existing definitions will be
replaced in-place. If a setting is added that doesn't already exist, it will be inserted
into the file _from_ line `setting_insertion_line`. Settings will be processed in array
order (see examples)

Default value: []

##### `entries`

Data type: `Hash[String,String]`

Hash of logging entries to create (see examples)

Default value: {}

##### `service_ensure`

Data type: `Enum['running','stopped']`

How to ensure the rsyslog service

Default value: "running"

##### `service_enable`

Data type: `Boolean`

`true` to start rsyslog on boot otherwise false

Default value: `true`

### r_profile::linux::samba_server

WIP easy samba support

### r_profile::linux::selinux

Features:
  * Set SELinux enforcement mode
  * Remove the setroubleshoot debug package (optional)
  * Set selinux booleans (`setsebool`)

* **See also**
https://forge.puppet.com/puppet/selinux/issues

#### Examples

##### Basic usage

```puppet
include r_profile::linux::selinux
```

##### Turn off SELinux

```puppet
r_profile::linux::selinux::sel_mode: "disabled"
```

##### Remove the debug package

```puppet
r_profile::linux::selinux::remove_troubleshoot: true
```

##### Enforce `setsebool` settings

```puppet
r_profile::linux::selinux::sebools:
  haproxy_connect_any: 1
```

#### Parameters

The following parameters are available in the `r_profile::linux::selinux` class.

##### `sel_mode`

Data type: `Optional[Enum["enforcing", "permissive", "disabled"]]`

Enforcment of the SELinux mode to apply to this node.  `undef` means
leave the current SELinux mode alone, the remaining allowed values force the
SELinux mode to be enforced as requested.  Don't forget that you usually have
to reboot after changing the mode.  To avoid accidentally rebooting systems
this module does not do this for you.

Default value: `undef`

##### `remove_troubleshoot`

Data type: `Boolean`

true to remove the setroubleshoot package, false to
leave it alone

Default value: `false`

##### `sebools`

Data type: `Hash[String,Optional[Hash]]`

Hash of sebool values to enforce (see examples)

Default value: {}

### r_profile::linux::sendmail

Features:
* Service configuable (default to stopped/disabled)
* Set daemon in /etc/sysconfig/sendmail
* Set queue in /etc/sysconfig/sendmail

* **See also**
https://forge.puppet.com/puppetlabs/stdlib

#### Examples

##### disable sendmail

```puppet
include r_profile::linux::sendmail
```

#### Parameters

The following parameters are available in the `r_profile::linux::sendmail` class.

##### `ensure`

Data type: `String`

`stopped` to shutdown sendmail if running, otherwise `running` to start

Default value: "stopped"

##### `enable`

Data type: `Boolean`

`false` to prevent sendmail from starting on boot otherwise false

Default value: `false`

##### `daemon`

Data type: `Enum["yes","no"]`

`no` to prevent sendmail from daemonising otherwise `yes`

Default value: "no"

##### `queue`

Data type: `String`

Interval at which to process the sendmail queue (`-q` parameter to `sendmail`)

Default value: "1h"

##### `service`

Data type: `String`

Name of the sendmail service

Default value: "sendmail"

### r_profile::linux::ssh

SSH support on linux using Augeas.

* **See also**
https://forge.puppet.com/geoffwilliams/ssh
https://forge.puppet.com/herculesteam/augeasproviders_ssh
https://forge.puppet.com/herculesteam/augeasproviders_core

#### Examples

##### Usage

```puppet
include r_profile::linux::ssh
```

##### Hiera data

```puppet
r_profile::linux::ssh::settings:
  permit_root_login: no
  banner: /etc/banner
```

#### Parameters

The following parameters are available in the `r_profile::linux::ssh` class.

##### `settings`

Data type: `Hash[String, Variant[String,Array[String]]]`

Hash of all settings to pass through to the SSH module. See above link for details

Default value: {}

### r_profile::linux::sudo

We take a minimal approach to management by just making sure that the package is installed and that the files we want
to manage exist at /etc/sudoers.d.

This non-destructive approach lets us only manage the sections of configuration we want to

Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.

#### Examples

##### Profile usage

```puppet
include r_profile::linux::sudo
```

##### Managing a fragment in /etc/sudoers.d

```puppet
r_profile::linux::sudo::sudoers_d:
  30_admin: "%admins ALL=(ALL) NOPASSWD: ALL"
```

#### Parameters

The following parameters are available in the `r_profile::linux::sudo` class.

##### `package`

Data type: `String`

Name of the sudo package

Default value: "sudo"

##### `sudoers_d_dir`

Data type: `String`

Directory where sudoers fragments can be kept

Default value: "/etc/sudoers.d"

##### `base_sudoers_d`

Data type: `Hash[String, String]`

Base hash of file content for for files to manage inside the `/etc/sudoers.d`
directory

Default value: {}

##### `sudoers_d`

Data type: `Hash[String, String]`

Override hash of file content for for files to manage inside the `/etc/sudoers.d`
directory

Default value: {}

##### `header`

Data type: `String`

Warning message to add to top of files we manage

Default value: "# This file is managed by Puppet; changes may be overwritten"

### r_profile::linux::sysconfig_init

Lockdown /etc/sysconfig/init settings (RHEL < 7)
* PROMPT=no
* SINGLE=/sbin/sulogin

Lockdown /etc/sysconfig/init settings (RHEL >= 7)
* PROMPT=no

In RHEL7, we must use systemd to configure what happens in single user mode. See r_profile::linux::systemd
Since umask can be set in many places it has its own profile, see r_profile::linux::umask

#### Examples

##### don't manage the PROMPT variable

```puppet
r_profile::linux::sysconfig_init::manage_prompt: false
```

##### don't manage the SINGLE variable

```puppet
r_profile::linux::sysconfig_init::manage_single: false
```

#### Parameters

The following parameters are available in the `r_profile::linux::sysconfig_init` class.

##### `manage_prompt`

Data type: `Any`

Manage the PROMPT variable if true otherwise do nothing

Default value: `true`

##### `manage_single`

Data type: `Any`

Manage the SINGLE variable if true otherwise do nothing

Default value: `true`

##### `manage_umask`

Data type: `Any`

Manage the umask setting if true otherwise do nothing

Default value: `true`

##### `umask`

Data type: `Any`

Value for umask (when managed)

Default value: "0027"

### r_profile::linux::sysctl

Settings will take place immediately when puppet is run and will also be
persisted /etc/sysctl.d to survive across reboots.  There is no support in
this class for removing entries that have previously been set since the
previous setting is unknowable.  If restoring a previously tuned parameter to
its default is required, the manual restoration steps on each agent are:
1.  Remove the setting from the passed in $settings list (hiera data)
2.  Remove the corresponding file under /etc/sysctl.d on the agent node
3.  Reboot...

Alternatively, set the $purge option to true and now puppet will remove
unmanaged files under /etc/sysctl.d for us.  The process now looks like this:
1.  Remove the setting from the passed in $settings list (hiera data)
2.  Reboot...

Settings to enforce should be passed as a hash via the settings parameter.

Puppet code:
  {
    'net.ipv4.conf.all.accept_redirects' => 0,
    'net.ipv4.tcp_syncookies'            => 1
  }

* **Note** Not to be confused with systemctl (services).

* **See also**
https://forge.puppet.com/geoffwilliams/sysctl

#### Examples

##### hiera data

```puppet
r_profile::linux::sysctl::settings:
  net.ipv4.conf.all.accept_redirects: 0
  net.ipv4.tcp_syncookies: 1
```

#### Parameters

The following parameters are available in the `r_profile::linux::sysctl` class.

##### `purge`

Data type: `Boolean`

Purge unmanaged files from /etc/sysctl.d

Default value: `false`

##### `base_settings`

Data type: `Hash[String, Any]`

Hash of settings as key=>value pairs (base)

Default value: {}

##### `settings`

Data type: `Hash[String, Any]`

Hash of settings as key=>value pairs (override)

Default value: {}

### r_profile::linux::system_users

Features:
* disable _system_ accounts (UID < 500/1000) by locking the shell
* ensure root group is 0
* lock inactive users
* Fix ownership on homedirs (owned by user, optionally set mode)
* Find and remove any 'override' files (.netrc, .rhosts, etc)
* Find and remove any NIS (`+`) entries from /etc/passwd,
  /etc/shadow, /etc/gshadow and /etc/group

system users (`system_uids` - uid < 1000)
- or -
low uid users (`low_uids` - uid < 500)

* **See also**
https://forge.puppet.com/geoffwilliams/system_users

#### Examples

##### class usage

```puppet
include r_profile::linux::system_users
```

##### Hiera data to lock low_uids

```puppet
r_profile::linux::system_users::uid_range: 'low_uids'
```

#### Parameters

The following parameters are available in the `r_profile::linux::system_users` class.

##### `uid_range`

Data type: `Enum['low_uids', 'system_uids']`

Range of UIDs to lockdown (see above)

Default value: 'system_uids'

### r_profile::linux::systemd

Provides:
  * `Exec['systemctl_daemon_reload']` to scan for changed units when puppet changes them (invoke via notify)
  * Enforcement of `sulogin` for rescue/emegency mode (this is the OS default)
  * Disable graphical login by changing the default target (replaces default runlevel from `/etc/inittab`)

* **See also**
https://forge.puppet.com/puppetlabs/stdlib

#### Examples

##### don't rewrite systemd files to require password for single user mode

```puppet
r_profile::linux::systemd::enforce_sulogin: false
```

##### disable booting to graphical login

```puppet
r_profile::linux::systemd::disable_graphical_login: true
```

#### Parameters

The following parameters are available in the `r_profile::linux::systemd` class.

##### `enforce_sulogin`

Data type: `Boolean`

`true` to ensure `sulogin` used, false to leave files unaltered

Default value: `true`

##### `disable_graphical_login`

Data type: `Boolean`

`true` to disable graphical logins otherwise `false` to leave files unaltered

Default value: `false`

### r_profile::linux::tcpwrappers

Setup tcpwrappers using geoffwilliams/tcpwrappers. We will merge
together a set of base level (SOE) rules and addtional/more
specific rules. This allows hiera to be kept simple without having
to worry about its merge capabilities.

#### Parameters

The following parameters are available in the `r_profile::linux::tcpwrappers` class.

##### `base_rules_allow`

Data type: `Array[Hash[String, String]]`

Basic set of rules for hosts.allow

Default value: []

##### `base_rules_deny`

Data type: `Array[Hash[String, String]]`

Basic set of rules for hosts.deny

Default value: []

##### `rules_allow`

Data type: `Array[Hash[String, String]]`

Additional rules for hosts.allow

Default value: []

##### `rules_deny`

Data type: `Array[Hash[String, String]]`

Additional rules for hosts.deny

Default value: []

##### `hosts_allow_content`

Data type: `Variant[String, Boolean]`

Full content for hosts.allow

Default value: `false`

##### `hosts_deny_content`

Data type: `Variant[String, Boolean]`

Full content for hosts.deny

Default value: `false`

### r_profile::linux::umask

Set the umask inside each of the requested files. The files must already exist in order to add a line
to them. r_profile::file can be used to do this if required.

* **See also**
https://forge.puppet.com/geoffwilliams/filemagic/readme

#### Examples

##### Activate the umask profile

```puppet
include r_profile::linux::umask
```

##### Hiera data to set a restrictive umask

```puppet
r_profile::linux::umask::default_umask: '0077'
```

##### Hiera data to set umask in several files with one exception

```puppet
r_profile::linux::umask::files:
  /etc/profile.d/umask.sh:
  /root/.bashrc:
  /var/lib/myapp/.bashrc: '0007'
```

#### Parameters

The following parameters are available in the `r_profile::linux::umask` class.

##### `default_umask`

Data type: `String`

Default umask value

Default value: '0022'

##### `files`

Data type: `Hash[String, Optional[String]]`

Hash of files to set the umask in. `default_umask` will be used unless a
file sets a value explicitly (see examples)

Default value: {}

### r_profile::linux::vim

Setup a nice version of vim

### r_profile::linux::wheel

Configure the `wheel` group on Linux

#### Parameters

The following parameters are available in the `r_profile::linux::wheel` class.

##### `gid`

Data type: `Integer`

GID of the wheel group, normally 10

Default value: 10

##### `wheel_su`

Data type: `Enum['present', 'absent']`

`present` to ensure wheel group required for `su` access, `absent` to allow anyone

Default value: 'present'

### r_profile::linux::yum

Common yum settings for RedHat

#### Parameters

The following parameters are available in the `r_profile::linux::yum` class.

##### `gpgcheck`

Data type: `Any`

1 to enable gpg checks otherwise false

Default value: '1'

##### `protected_multilib`

Data type: `Any`

1 to protect against installing 'multilib' libraries
(Libraries from architectural variants)

Default value: '1'

### r_profile::linux::yumrepo

Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.

* **See also**
https://puppet.com/docs/puppet/5.5/types/yumrepo.html

#### Examples

##### Puppet code to define a stage and run this class in it

```puppet
stage { "yumrepos":
  before => Stage["main"],
}
class { "r_profile::linux::yumrepo"
  stage => "yumrepos"
}
```

##### Alternatively, use the `r_profile::repo` class to instantate this class

```puppet
# must add _this_ class to the list of classes to include `r_profile::repo::profiles`
include r_profile::repo
```

##### Hiera data to setup a custom hosted yum repository

```puppet
r_profile::linux::yumrepo:yumrepos
  Artifactory:
    baseurl: http://artifactory.megacorp.com
    enabled: 1
    gpgcheck: 0
```

#### Parameters

The following parameters are available in the `r_profile::linux::yumrepo` class.

##### `base_yumrepos`

Data type: `Hash[String, Hash]`

Hash of yum repositories to ensure (base)

Default value: {}

##### `yumrepos`

Data type: `Hash[String, Hash]`

Hash of yum repositories to ensure (overrides)

Default value: {}

### r_profile::lockdown::at

Features:
  *Manage `at.allow` and `at.deny` files

#### Parameters

The following parameters are available in the `r_profile::lockdown::at` class.

##### `ensure`

Data type: `Boolean`

true to enable lockdown of `at` otherwise false

Default value: hiera('r_profile::lockdown::at::ensure', false)

### r_profile::lockdown::group

Lockdown groups by removing them.

#### Parameters

The following parameters are available in the `r_profile::lockdown::group` class.

##### `delete`

Data type: `Array[String]`

Array of groups to delete from the system

Default value: hiera("r_profile::lockdown::group::delete", [])

### r_profile::lockdown::package

Purge the passed-in packages from the system

#### Examples

##### Hiera data

```puppet
r_profile::lockdown::package::delete:
  - ypserv
  - talk-server
  - ["Server with GUI", yum_group]
```

##### Declaration

```puppet
include r_profile::lockdown::package
```

#### Parameters

The following parameters are available in the `r_profile::lockdown::package` class.

##### `delete`

Data type: `Array[Variant[String, Array[String]]]`

Array of packages to remove. If you need to specify a provider to remove a particular type of package
(gem, egg, yum_group, etc.) then specify an array containing package name and provider (see example)

Default value: hiera("r_profile::lockdown::package::delete", [])

### r_profile::lockdown::user

Alternatively, we will remove all users named in the delete parameter.  Note that it is an error
to attempt to both disable and remove a user, since disabling requires that
the user still be present to update /etc/shadow and /etc/password.  This will
manifest as a duplicate declaration error if encountered in the field.

#### Parameters

The following parameters are available in the `r_profile::lockdown::user` class.

##### `disable_password`

Data type: `Array[String]`

Array of usernames who should have their password locked

Default value: hiera("r_profile::lockdown::user::disable_password", [])

##### `disable_shell`

Data type: `Array[String]`

Array of usernames who should have their shell disabled

Default value: hiera("r_profile::lockdown::user::disable_shell", [])

##### `delete`

Data type: `Array[String]`

Array of usernames who should be deleted from the system

Default value: hiera("r_profile::lockdown::user::delete", [])

### r_profile::monitor::nagios_monitored

Configure nagios to monitor something

#### Parameters

The following parameters are available in the `r_profile::monitor::nagios_monitored` class.

##### `nagios_server`

Data type: `Optional[String]`

Hostname of nagios server

Default value: `undef`

### r_profile::monitor::nagios_server

Confifgure nagios server

#### Parameters

The following parameters are available in the `r_profile::monitor::nagios_server` class.

##### `password`

Data type: `Optional[String]`

Password to use for nagios

Default value: `undef`

### r_profile::motd

Simple MOTD support for POSIX and Windows.

* **See also**
https://forge.puppet.com/geoffwilliams/motd/readme

#### Examples

##### Hiera data to set `/etc/motd`, `/etc/issue` and `/etc/issue.net` to the same message

```puppet
r_profile::motd::content: |
  %{facts.fqdn}
  ===================================================================
  This box is managed by Puppet Enterprise and is a cowboy free zone!

_results in_

pe-puppet.localdomain
===================================================================
This box is managed by Puppet Enterprise and is a cowboy free zone!
```

##### Hiera data for /etc/motd (message once logged in)

```puppet
r_profile::motd::identical_content: false
r_profile::motd::content: |
  ...
```

##### Hiera data for /etc/issue (pre-login message)

```puppet
r_profile::motd::identical_content: false
r_profile::motd::issue: |
  ...
```

##### Hiera data for /etc/issue.net (pre-login message for telnet and other nominated services)

```puppet
r_profile::motd::identical_content: false
r_profile::motd::issue.net: |
  ...
```

##### Hiera data for blank MOTD (no message)

```puppet
r_profile::motd::content: false
```

#### Parameters

The following parameters are available in the `r_profile::motd` class.

##### `content`

Data type: `Variant[Boolean, Optional[String]]`

The message to use for login message (or all messages) on all platforms or `false` to write an empty
file

Default value: `undef`

##### `issue_content`

Data type: `Variant[Boolean, Optional[String]]`

The message  to be used for `/etc/issue` (pre-login message - linux only) or `false` to write an
empty file

Default value: `undef`

##### `issue_net_content`

Data type: `Variant[Boolean, Optional[String]]`

The message to be used for `/etc/issue.net` (pre-login message for telnet/other nominated
services - linux only) or `false` to write an empty file

Default value: `undef`

##### `identical_content`

Data type: `Boolean`

`true` to use the main MOTD message from `content` for all messages unless overriden
individually by `issue_content` and `issue_net` (linux only)

Default value: `true`

### r_profile::mount

Configure filesystem mounts using the puppet

* **See also**
https://puppet.com/docs/puppet/5.5/types/mount.html

#### Examples

##### mounting a partition on `/opt`

```puppet
r_profile::mount::mount:
  '/opt':
    ensure: mounted
    atboot: true
    options: 'nodev'
    device: '/dev/sdc1'
    fstype: ext4
```

#### Parameters

The following parameters are available in the `r_profile::mount` class.

##### `mounts`

Data type: `Hash[String, Optional[Hash]]`

hash of mounts to mount

Default value: {}

##### `default_mounts`

Data type: `Hash[String, Optional[Hash]]`

default hash of default mount options

Default value: {}

### r_profile::nginx

Support for Nginx webserver

### r_profile::nodejs

The r_profile::nodejs class.

#### Parameters

The following parameters are available in the `r_profile::nodejs` class.

##### `repo_url_suffix`

Data type: `Any`

Hints at what version of nodejs to install

Default value: hiera("r_profile::nodejs::repo_url_suffix", undef)

##### `repo_class`

Data type: `Any`

Use a specific respository, eg `epel`

Default value: hiera("r_profile::nodejs::repo_class", undef)

### r_profile::ntp

Windows users gain NTP by joining a domain. There is no support for standalone windows NTP yet

Supports:
* AIX
* Solaris
* Linux

* **Note** Newer Linux systems should use `r_profile::linux::chronyd`

* **See also**
https://forge.puppet.com/puppetlabs/ntp

#### Examples

##### setup default NTP client

```puppet
include r_profile::ntp
```

##### Hiera data for setting the server(s) to use

```puppet
r_profile::ntp::servers:
  - time.windows.com
  - pool.ntp.org
```

##### Hiera data to prevent trying to manage the package

```puppet
r_profile::ntp::package_manage: false
```

##### Hiera data to prevent trying to manage the service

```puppet
r_profile::ntp::service_manage: false
```

#### Parameters

The following parameters are available in the `r_profile::ntp` class.

##### `servers`

Data type: `Optional[Array[String]]`

Array of servers to ask for the time

Default value: `undef`

##### `package_manage`

Data type: `Optional[Boolean]`

True if we should install ntp otherwise false

Default value: `undef`

##### `service_manage`

Data type: `Optional[Boolean]`

True if we should control the ntpd service otherwise false

Default value: `undef`

### r_profile::package

Install software using Puppet's built-in `package` resource.

* **See also**
https://puppet.com/docs/puppet/5.5/types/package.html

#### Examples

##### Hiera data for installing packages

```puppet
r_profile::package::packages:
  tree:
  samba:
```

##### Hiera data to removing packages

```puppet
r_profile::package::packages:
  telnet:
    ensure: absent
```

##### Hiera data to install a particular version of a package

```puppet
r_profile::package::packages:
  "java-1.8.0-openjdk":
    ensure: "1.8.0.171-8.b10.el7_5"
```

##### Hiera data to install using a different package provider

```puppet
r_profile::package::packages:
  nokogiri:
    provider: gem
```

#### Parameters

The following parameters are available in the `r_profile::package` class.

##### `base_packages`

Data type: `Hash[String, Optional[Hash]]`

Hash of basic packages to install.  Using a hash allows the provider options to be specified

Default value: {}

##### `packages`

Data type: `Hash[String, Optional[Hash]]`

Hash of additional packages to install.  Using a hash allows the provider options to be specified

Default value: {}

### r_profile::puppet::master

Enable restarting the `pe-puppetserver` service if its systemd environment is changed

#### Parameters

The following parameters are available in the `r_profile::puppet::master` class.

##### `sysconf_puppetserver`

Data type: `String`

Path to sysconfig settings for pe-puppetserver

Default value: "${facts['sysconf_dir']}/pe-puppetserver"

### r_profile::puppet::master::agent_installers

Puppet Enterprise doesn't ship with the installers needed for every platform included in the installation media.'Users
must instead follow the steps at https://puppet.com/docs/pe/2018.1/installing/installing_agents.html#ariaid-title2
which involves createating classifier groups and manually classifying each installer you wish to provide.

This class automates the process by:
  1. A custom function that inspects the puppet master for the avaiable installer classes
  2. Include each class so that the agent installer will be downloaded (requires internet access/proxy be setup)

There are 1GB+ of installers to download so this can take a long time

#### Examples

##### Download all agent installers

```puppet
include r_profile::puppet::master::agent_installers
```

##### Hiera data to prevent agent installer download

```puppet
r_profile::puppet::master::agent_installers::install: false
```

#### Parameters

The following parameters are available in the `r_profile::puppet::master::agent_installers` class.

##### `install`

Data type: `Boolean`

`true` to install all main Puppet agent installers, `false` to skip downloading

Default value: `true`

### r_profile::puppet::master::autosign

Features:
  * Policy based autosigning @https://puppet.com/docs/puppet/5.5/ssl_autosign.html#policy-based-autosigning
  * Naive autosigning @see https://puppet.com/docs/puppet/5.5/ssl_autosign.html#nave-autosigning
  * No autosigning @see https://puppet.com/docs/puppet/5.5/ssl_autosign.html#disabling-autosigning

If Policy based autosigning is enabled, then a script to check for the presence of the shared secret passed in
`secret` will be created for you. If you would rather install your own script then you may pass the body of the script
file in `script_content` and this profile will write it out for you.

In all cases `autosign.conf` is removed. This file offers pattern-based autosigning which does not fit the above
patterns yet may still be present on the system.

* **See also**
#
@see https://forge.puppet.com/puppetlabs/inifile

#### Examples

##### Hiera to enable signing all certificates

```puppet
r_profile::puppet::master::autosign::ensure: accept_all
```

##### Hiera to enable policy based autosigning with a shared secret (encrypted with eyaml)

```puppet
r_profile::puppet::master::autosign::ensure: policy
r_profile::puppet::master::autosign::secret: >
  ENC[PKCS7,Y22exl+OvjDe+drmik2XEeD3VQtl1uZJXFFF2NnrMXDWx0csyqLB/2NOWefv
  NBTZfOlPvMlAesyr4bUY4I5XeVbVk38XKxeriH69EFAD4CahIZlC8lkE/uDh
  jJGQfh052eonkungHIcuGKY/5sEbbZl/qufjAtp/ufor15VBJtsXt17tXP4y
  l5ZP119Fwq8xiREGOL0lVvFYJz2hZc1ppPCNG5lwuLnTekXN/OazNYpf4CMd
  /HjZFXwcXRtTlzewJLc+/gox2IfByQRhsI/AgogRfYQKocZgFb/DOZoXR7wm
  IZGeunzwhqfmEtGiqpvJJQ5wVRdzJVpTnANBA5qxeA==]
```

##### Hiera to enable policy based autosigning with your own custom script

```puppet
r_profile::puppet::master::autosign::ensure: policy
r_profile::puppet::master::autosign::script_content: |-
  #!/bin/bash
  echo "Hello, World!"
```

#### Parameters

The following parameters are available in the `r_profile::puppet::master::autosign` class.

##### `ensure`

Data type: `Enum['policy', 'absent', 'accept_all']`

Autosigning technique to use on this puppet master (see above)

Default value: 'absent'

##### `script_content`

Data type: `Optional[String]`

If you would like to pass in your own script, pass a string of the content here or leave blank
to use the built-in shared secret check

Default value: `undef`

##### `secret`

Data type: `Optional[String]`

Shared secret to use when configuring policy based autosigning (only for built-in shared-secret script)

Default value: `undef`

##### `autosign_script`

Data type: `String`

Path to save the autosigning script

Default value: "/usr/local/bin/puppet_enterprise_autosign.sh"

### r_profile::puppet::master::db_backup

Install a cron job to backup the PE postgres server

* **Note** Takescomplete dump of the database

#### Parameters

The following parameters are available in the `r_profile::puppet::master::db_backup` class.

##### `ensure`

Data type: `Enum['present', 'absent']`

`present` to create the cron job, `absent` to remove it

Default value: hiera("r_profile::puppet::master::db_backup::ensure",   "present")

##### `dir`

Data type: `String`

Directory to dump database to

Default value: hiera("r_profile::puppet::master::db_backup::dir",      "/tmp")

##### `hour`

Data type: `String`

Cron hour to commence database dump

Default value: hiera("r_profile::puppet::master::db_backup::hour",     "5")

##### `minute`

Data type: `String`

Cron minute to commence database dump

Default value: hiera("r_profile::puppet::master::db_backup::minute",   "0")

##### `month`

Data type: `String`

Cron month to commence database dump

Default value: hiera("r_profile::puppet::master::db_backup::month",    "*")

##### `monthday`

Data type: `String`

Cron monthday to commence database dump

Default value: hiera("r_profile::puppet::master::db_backup::monthday", "*")

##### `weekday`

Data type: `String`

Cron weekday to commence database dump

Default value: hiera("r_profile::puppet::master::db_backup::weekday",  "*")

### r_profile::puppet::master::git_server

Works by creating a bare git grepository accessed via SSH and configuring Code Manager to use it

#### Parameters

The following parameters are available in the `r_profile::puppet::master::git_server` class.

##### `enable`

Data type: `Boolean`

true to enable the git server, otherwise do nothing

Default value: hiera('r_profile::puppet::master::git_server::enable', true)

### r_profile::puppet::master::hiera5

Enable support for Hiera v5 system-wide by copying-in a golden `hiera.yaml`
file and restarting puppet.  Individual environments can then specify the
hiera hierarchy they want to use as required.

The inserted file defines a global hierarchy file for use by puppet at
`/etc/puppetlabs/puppet_enterprise.yaml`. This is a file NOT managed by git
and is for putting settings to re-configure puppet enterprise without using
git, as directed by support/documentation. The main use of this _trick_ is
to enable the initial `puppet code deploy` to succeed when using a private
forge

### r_profile::puppet::master::hiera_eyaml

Configure hiera-eyaml by generating the encryption keys. Current versions of
Puppet Enterprise ~2018x ship a vendored eyaml gem so installation is not
needed anymore.

Beware that if you are running Puppet Enterprise and install the
`puppetlabs-puppetserver_gem` module, you will run into ENTERPRISE-1179. To
fix this, you must remove `puppetlabs-puppetserver_gem` from your
`Puppetfile` and re-deploy code.

If you must install hiera-eyaml gem for some reason, then you will have to
install `puppetlabs-puppetserver_gem` module and follow the example below to
enable gem installation.

If you want more then one keypair per server then you should not use this class.

The example below shows how to generate eyaml on the Puppet Master. By sharing
the server's public key this process can be carried out anywhere and does
not require root access to the Puppet Master.

* **See also**
https://tickets.puppetlabs.com/browse/ENTERPRISE-1179
https://forge.puppet.com/puppetlabs/puppetserver_gem

#### Examples

##### Install the hiera-eyaml gems (not needed for modern Puppet Enterprise)

```puppet
r_profile::puppet::master::hiera_eyaml::gem_install: true
```

##### Prevent key creation

```puppet
r_profile::puppet::master::hiera_eyaml::create_keys: false
```

##### encrypting data on the Puppet Master

```puppet
cd /etc/puppetlabs/puppet
/opt/puppetlabs/puppet/lib/ruby/vendor_gems/bin/eyaml encrypt --password
```

#### Parameters

The following parameters are available in the `r_profile::puppet::master::hiera_eyaml` class.

##### `create_keys`

Data type: `Boolean`

True to create a system-wide eyaml keypair

Default value: `true`

##### `gem_install`

Data type: `Boolean`

True to attempt to install and configure hiera-eyaml rubygem

Default value: `false`

### r_profile::puppet::master::license

This works by symlinking the license.key file from your control repository to the correct location on
the puppet master.  To upgrade or alter your license information, just update
the file in the control repository (production branch) and then deploy to the
master as usual.

#### Examples

##### 

```puppet
include r_pofile::puppet::master::license
```

### r_profile::puppet::master::proxy

for this

If using this class you must also declare `r_profile::puppet::master` in order
to manage and notify `Service['pe-puppetserver']`

* **Note** This does not configure the master's agent. Use `r_profile::linux::puppet_agent`

* **See also**
https://forge.puppet.com/puppetlabs/inifile
https://forge.puppet.com/puppetlabs/stdlib

#### Examples

##### setting the proxy server

```puppet
r_profile::puppet::master::proxy::proxy: http://proxy.megacorp.com:3128
```

##### disable proxy server (the default)

```puppet
r_profile::puppet::master::proxy::proxy: false
```

#### Parameters

The following parameters are available in the `r_profile::puppet::master::proxy` class.

##### `proxy`

Data type: `Variant[String, Boolean]`

proxy server to use in the form http://user@pass:proxyhost:proxyport or `false` to not use a proxy server

Default value: `false`

##### `sysconf_puppetserver`

Data type: `String`

Path to systemd/init environment file for PuppetServer

Default value: "${facts['sysconf_dir']}/pe-puppetserver"

##### `puppetconf_proxy`

Data type: `Boolean`

`true` to also add proxy information to `puppet.conf`. If set, all operations on Puppet will
use the proxy server and there is no ability to bypass, so this will break commands such as `puppet node`. If we
are deconfigiuring a proxy server, then always remove proxy server info from `puppet.conf`.
@see ENTERPRISE-1175

Default value: `false`

### r_profile::puppet::nr_agent

Typically useful if you want to manage cloud resources with puppet and reqiure
multiple puppet agents to do so.

Rquires that your puppet master hostname is resolvable already, either via DNS
or `/etc/hosts`

Since puppet must already be installed on a node (as root) to be able to run
this class, we do not attempt to (re)install puppet.  This means we cannot use
the puppet curl|bash installer and must instead create the appropriate settings
files and services

#### Examples

##### Installing non-root agents

```puppet
class { "r_profile::puppet::nr_agent":
  puppet_master_fqdn => "puppet.megacorp.com",
  agents             => {
    "azureprovisioner.megacorp.com" => {
      "user"    => "puppet_azure",
      "secret"  => "shared_secret_for_autosigning",
    }
  },
}
```

#### Parameters

The following parameters are available in the `r_profile::puppet::nr_agent` class.

##### `puppet_master_fqdn`

Data type: `String`

The FQDN of the puppet master

Default value: hiera("r_profile::puppet::nr_agent::puppet_master_fqdn", undef)

##### `agents`

Data type: `Optional[Hash]`

Hash of agents to install, where each hash member's key is the
certname of the agent to install and the value is a hash of options for this
agent

Default value: hiera("r_profile::puppet::nr_agent::agents")

### r_profile::repo

Declare (instantiate) the required profile classes in a stage before `main`: `repo`.
The reason for this class to exist is because it is not possible for classes to
self-define their own runstage. It _must_ be passed using resource style class
declaration as a simple string.

* **See also**
https://puppet.com/docs/puppet/5.5/lang_run_stages.html

#### Examples

##### Declare all requested repositories, setting up the `repo` runstage

```puppet
include profile::repo
```

##### Providing the list of repository profiles to load

```puppet
r_profile::repo::profiles:
  - r_profile::linux::yumrepo
```

#### Parameters

The following parameters are available in the `r_profile::repo` class.

##### `profiles`

Data type: `Array[String]`

Array of profile classes to load in the `repo` stage

Default value: []

##### `stage_name`

Data type: `String`

Name of the stage to process repositories in (before `main`)

Default value: "repo"

### r_profile::ruby

While its possible to use Puppet's vendored ruby for everything, its safter
for customers to install their own ruby for internal apps to use since
otherwise messing with the gems could break puppet in such a way that it is
unable to run, leaving the system unmanaged

#### Parameters

The following parameters are available in the `r_profile::ruby` class.

##### `version`

Data type: `Any`

Array of Ruby versions to install (linux).  On windows, only
a single version can be installed due to packaging so we will install the
first listed version.  On linux, the first listed version will be set as the
default

Default value: hiera('r_profile::ruby::version', ['2.4.1', '2.3.4'])

##### `gems`

Data type: `Any`

Hash of default gems to install in a form suitable for
create_resources of the `rbenv::gem` type (not recommened - please use
bundler for day-to-day gem installation).  IMPORTANT:  Bundler is
already installed as part of rbenv::build, attempting installation
here as well will cause duplicate resource error
@see https://forge.puppet.com/jdowning/rbenv#full-example

Default value: hiera('r_profile::ruby::gems', {})

##### `install_dir`

Data type: `Any`

Install ruby in this directory

Default value: `undef`

### r_profile::service

By default enable services to start on boot and be running.

We take both a `base` and override hash of services and merge them to form a final list. This allows for simpler
management through hiera.

#### Examples

##### Hiera data to ensure service is enabled on boot and running

```puppet
r_profile::service::services:
  ntpd:
  sshd
```

##### Hiera data to ensure service stopped and not available on boot

```puppet
r_profile::service::services:
  xinetd:
    ensure: stopped
    enable: false
```

#### Parameters

The following parameters are available in the `r_profile::service` class.

##### `base_services`

Data type: `Hash[String, Optional[Hash]]`

Base hash of services to manage (see examples)

Default value: {}

##### `services`

Data type: `Hash[String, Optional[Hash]]`

Override hash of services to manage (see examples)

Default value: {}

### r_profile::timezone

Currently supports Linux, Solaris, AIX and Windows.  Timezone names for linux
need to match the Olsen names available on the current system.  On Linux,
these are normally found under `/usr/share/zoneinfo`. On Windows the timezone
needs to match a name from `tzutil -l`

* **See also**
https://forge.puppet.com/geoffwilliams/timezone
https://forge.puppet.com/geoffwilliams/windows_timezone
https://en.wikipedia.org/wiki/Tz_database
https://github.com/GeoffWilliams/puppet-windows_timezone/blob/master/doc/windows_timezones.txt

#### Examples

##### Usage

```puppet
include r_profile::timezone
```

##### Setting the timezone for Linux

```puppet
r_profile::timezone::zone: "Pacific/Honolulu"
```

##### Setting the timezone for Windows

```puppet
r_profile::timezone::zone: "Hawaiian Standard Time"
```

#### Parameters

The following parameters are available in the `r_profile::timezone` class.

##### `zone`

Data type: `Optional[String]`

Timezone to set this node to, eg 'Asia/Hong_Kong'

Default value: `undef`

### r_profile::user

Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.

#### Examples

##### Heira data to create a user with an authorised key

```puppet
r_profile::user::users:
  alice:
    password: '$6$5XEywcNV$3txL0NS1cdR2coRI5bl1H2Sp6WOv8TLYG/BO3QtaeMKTRu9vlUCrYW9sZxsdGruZMI3SP8/B.DE8bl7rPV3p80'
    authorized_keys: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9qYQmWOu2ryYJpPGT1HJqmBFTxxzda+7TgERu17S2CCVT1DKhFmGk5Pc1h/B6R4vKV1Pqs\
      +vBzhsNfOHROS2WlqNQlnIJkagCqAO7EXggt5mV0N8zxQ/a0CkS0ve3BjUGMt/X2Ol2LF3nXGJes+c6kU6AHFZHb/g4oQNsvDjxbl5hDUeBH4\
      8NNf55JexyOGDH4EOg5G6634stqqa6ZqMX4/E4n0nPpb6BoaYSkNra+v3p1w7ZTm3stA8Nl8BZ1UkwmVxfEmGdXQ+c3lrwHlIJRGr6KgCjCjX\
      tjK1sr2oRQc3j2yCGjPrI5M1eusipk8vLdsSkSm/dFzPQqpdtML3X root@agent.localdomain"
# refer https://stackoverflow.com/a/21699210 for the insane encoding rules for yaml
# note the backslash at end of line and quotes around the whole key. This ends up as
# a single line in the target file without needing a really long line in yaml
```

##### Hiera data to create a group

```puppet
r_profile::user::groups:
  alice:
    gid: 100
```

#### Parameters

The following parameters are available in the `r_profile::user` class.

##### `base_users`

Data type: `Hash[String, Optional[Hash]]`

Hash of user resources to create (suitable for `user` resource)

Default value: {}

##### `users`

Data type: `Hash[String, Optional[Hash]]`

Hash of user resources to create (suitable for `user` resource)

Default value: {}

##### `base_groups`

Data type: `Hash[String, Optional[Hash]]`

Hash of group resources to create (suitable for `group` resource)

Default value: {}

##### `groups`

Data type: `Hash[String, Optional[Hash]]`

Hash of group resources to create (suitable for `group` resource)

Default value: {}

### r_profile::virtual::vagrant

Support for managing VMs via Vagrant (experimental)

#### Parameters

The following parameters are available in the `r_profile::virtual::vagrant` class.

##### `vms`

Data type: `Hash`

Hash of VMs to install in a suitable format for create_resources
and `vagrant_vm`

Default value: {}

##### `vm_default`

Data type: `Hash`

Hash of default options for `vagrant_vm`

Default value: {}

### r_profile::virtual::virtual_box

Install Oracle VirtualBox

* **See also**
https://forge.puppet.com/puppet/virtualbox

#### Parameters

The following parameters are available in the `r_profile::virtual::virtual_box` class.

##### `version`

Data type: `Optional[String]`

Version to install, installs latest if unspecified

Default value: `undef`

### r_profile::web_service::apache

Install and configure Apache webserver

#### Parameters

The following parameters are available in the `r_profile::web_service::apache` class.

##### `website_hash`

Data type: `Hash`

Hash of websites to create in a suitable for for create_resources
and the apache::vhost resource

Default value: {}

##### `disable_php`

Data type: `Boolean`

`true` to disable support for PHP otherwise it will be installed

Default value: `false`

##### `disable_mysql`

Data type: `Boolean`

`true` to disable support for mysql in PHP otherwise enable it

Default value: `false`

##### `ip`

Data type: `Optional[String]`

IP address or array of IP addresses to listen on.  Default is to listen
on all interfaces

Default value: `undef`

### r_profile::web_service::iis

Install and configure IIS web server

#### Parameters

The following parameters are available in the `r_profile::web_service::iis` class.

##### `website_owner`

Data type: `String`

File ownership for webserver

Default value: "IUSR_${hostname}"

##### `website_group`

Data type: `String`

File ownership for webserver

Default value: 'Administrators'

##### `website_hash`

Data type: `Hash`

Hash of websites to create

Default value: {}

##### `ensure_default`

Data type: `Enum['present', 'absent']`

How to ensure the default website (`absent` or `present`)

Default value: present

### r_profile::web_service::tomcat

Install and configure tomcat application server

* **See also**
https://forge.puppet.com/puppetlabs/tomcat

#### Parameters

The following parameters are available in the `r_profile::web_service::tomcat` class.

##### `source_url`

Data type: `String`

URL to file to install tomcat from

Default value: 'http://apache.mirror.amaze.com.au/tomcat/tomcat-8/v8.5.14/bin/apache-tomcat-8.5.14.tar.gz'

##### `catalina_home`

Data type: `String`

Path to install tomcat

Default value: '/opt/tomcat'

##### `service`

Data type: `String`

Name of the tomcat service

Default value: 'tomcat'

##### `user`

Data type: `String`

User to run tomcat as

Default value: 'tomcat'

##### `group`

Data type: `String`

Group for `user`

Default value: 'tomcat'

##### `port`

Data type: `Integer`

TCP port to run on

Default value: 8080

### r_profile::webapp::geoserver

Support for install GeoServer - A server-side Java GIS

* **See also**
https://forge.puppet.com/puppetlabs/tomcat
https://forge.puppet.com/puppet/archive

#### Parameters

The following parameters are available in the `r_profile::webapp::geoserver` class.

##### `version`

Data type: `Any`

Version number to install

Default value: '2.9.1'

##### `download_base`

Data type: `Any`

Base URL to download from

Default value: 'http://sourceforge.net/projects/geoserver/files/GeoServer'

### r_profile::webapp::git_site

Deploy web site(s) from git

#### Examples

##### Downloading site from git

```puppet
r_profile::webapp::git_site:
  /var/www/phpquote:
    source: https://github.com/GeoffWilliams/phpquote
    revision: master
    notify: Service['httpd']
```

#### Parameters

The following parameters are available in the `r_profile::webapp::git_site` class.

##### `sites`

Data type: `Hash[String, Hash[String, Any]]`

Hash of checkout sources and destinations (see examples)

Default value: {}

### r_profile::webapp::php_config

```puppet
config_filename => {
  owner => 'user',  # config file owner
  group => 'group', # config file group
  mode  => '0640',  # config file permissions
  notify => RES,    # resources to notify on change
  defines   => {},  # PHP define KVPs to write in key=>value format
  vars      => {},  # PHP variable KVPs to write in key=>value format
}
```

#### Parameters

The following parameters are available in the `r_profile::webapp::php_config` class.

##### `configs`

Data type: `Any`

Hash of configuration filenames and values to write:

Default value: hiera('r_profile::webapp::php_config', {})

### r_profile::webapp::wordpress

Install wordpress CMS using `hunner-wordpress`

### r_profile::windows::base

Basic 'baselevel' class for Windows

### r_profile::windows::chocolatey

Setup chocolatey package manager on Windows

* **See also**
https://forge.puppet.com/puppetlabs/chocolatey
https://forge.puppet.com/puppet/windows_env

#### Examples

##### Basic usage

```puppet
include r_profile::windows::chocolatey
```

##### Chocolatey settings

```puppet
r_profile::windows::chocolatey:
  settings:
    chocolatey_download_url: 'https://internalurl/to/chocolatey.nupkg'
    use_7zip: false
    choco_install_timeout_seconds: 2700
```

#### Parameters

The following parameters are available in the `r_profile::windows::chocolatey` class.

##### `chocolatey_path`

Data type: `String`

Add this directory to the `PATH` variable for easy access to the `choco` command

Default value: "c:/ProgramData/chocolatey"

##### `settings`

Data type: `Hash[String,Any]`

Hash of settings to pass to main chocolatey installer module

Default value: {}

### r_profile::windows::domain_membership

Join an Active Directory domain using Puppet

* **See also**
https://forge.puppet.com/trlinkin/domain_membership

#### Examples

##### Join a domain

```puppet
include r_profile::windows::domain_membership
```

#### Parameters

The following parameters are available in the `r_profile::windows::domain_membership` class.

##### `domain`

Data type: `String`

AD domain which the node should be a member of.

Default value: hiera("r_profile::windows::domain_membership::domain")

##### `username`

Data type: `String`

User with ability to join machines to a Domain.

Default value: hiera("r_profile::windows::domain_membership::username")

##### `password`

Data type: `String`

Password for domain joining user.

Default value: hiera("r_profile::windows::domain_membership::password")

##### `machine_ou`

Data type: `Optional[String]`

OU in the directory for the machine account to be created in.

Default value: hiera("r_profile::windows::domain_membership::machine_ou", undef)

##### `resetpw`

Data type: `Optional[String]`

Whether or not to force machine password reset if it becomes
out of sync with the domain.

Default value: hiera("r_profile::windows::domain_membership::resetpw", undef)

##### `reboot`

Data type: `Optional[String]`

Whether or not to reboot when the machine joins the domain.

Default value: hiera("r_profile::windows::domain_membership::reboot", undef)

##### `join_options`

Data type: `Optional[String]`

A bit field for options to use when joining the domain.
A value of '1' indicates default domain join (the default)
@see http://msdn.microsoft.com/en-us/library/aa392154(v=vs.85).aspx

Default value: hiera("r_profile::windows::domain_membership::join_options", undef)

##### `user_domain`

Data type: `Optional[String]`

Domain of user account used to join machine, if different
from domain machine will be joined to. If not specified, the value passed to
the domain parameter will be used.

Default value: hiera("r_profile::windows::domain_membership::user_domain", undef)

### r_profile::windows::firewall

Features:
  * Global settings
  * Per-profile settings
  * Enable/disable rulegroups by name
  * Mange firewall rules

Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.

* **See also**
https://forge.puppet.com/geoffwilliams/windows_firewall

#### Examples

##### turning off all firewalls

```puppet
r_profile::windows::firewall::profiles:
  private:
    state: off
  public:
    state: off
  domain:
    state: off
```

##### Ensuring firewall rules

```puppet
r_profile::windows::firewall::rules:
  'Windows Remote Management HTTP-In':
    direction: 'in'
    action: 'allow'
    enabled: 'yes'
    protocol: 'TCP'
    localport: 5985
    remoteport: 'any'
    description: 'Inbound rule for Windows Remote Management via WS-Management. [TCP 5985]'
  'IIS Web Server':
    direction: 'in'
    action: 'allow'
    enabled: 'yes'
    protocol: 'TCP'
    localport: 80
    remoteport: 'any'
    description: 'Inbound rule for IIS Web Server. [TCP 80]'
```

##### Configuring per-profile settings

```puppet
r_profile::windows::firewall::profiles:
  private:
    filename: '%systemroot%\system32\logfiles\firewall\pfirewall.log'
    firewallpolicy: 'blockinbound,allowoutbound'
    inboundusernotification: 'disable'
    logallowedconnections: 'disable'
    logdroppedconnections: 'disable'
    maxfilesize: '4096'
    remotemanagement: 'disable'
    state: 'on'
    unicastresponsetomulticast: 'enable'
```

##### Configuring global firewall settings

```puppet
r_profile::windows::firewall::global:
  authzcomputergrp: 'none'
  authzusergrp: 'none'
  defaultexemptions:
    - 'neighbordiscovery'
    - 'dhcp'
  forcedh: 'yes'
  ipsecthroughnat: 'serverbehindnat'
  keylifetime: '485min,0sess'
  saidletimemin: '6'
  secmethods: 'dhgroup2:aes128-sha1,dhgroup2:3des-sha1'
  statefulftp: 'disable'
  statefulpptp: 'disable'
  strongcrlcheck: '1'
```

##### Enabling a group of rules

```puppet
r_profile::windows::firewall::group:
  "file and printer sharing":
    enabled: "yes"
```

##### Purging unmanaged rules (use with caution!)

```puppet
r_profile::windows::firewall::purge_rules: true
```

#### Parameters

The following parameters are available in the `r_profile::windows::firewall` class.

##### `base_profiles`

Data type: `Hash[String, Hash]`

Base profile settings (see examples)

Default value: {}

##### `profiles`

Data type: `Hash[String, Hash]`

Override profile settings (see examples)

Default value: {}

##### `base_rules`

Data type: `Hash[String, Hash]`

Base rules (see examples)

Default value: {}

##### `rules`

Data type: `Hash[String, Hash]`

Override rules (see examples)

Default value: {}

##### `base_global`

Data type: `Hash[String, Hash]`

Base global settings (see examples)

Default value: {}

##### `global`

Data type: `Hash[String, Hash]`

Override global settings (see examples)

Default value: {}

##### `base_groups`

Data type: `Hash[String, Hash]`

Base group settings (see examples)

Default value: {}

##### `groups`

Data type: `Hash[String, Hash]`

Override group settings (see examples)

Default value: {}

##### `purge_rules`

Data type: `Boolean`

`true` to purge all unmanaged firewall rules, otherwise
leave existing rules in place

Default value: `false`

### r_profile::windows::notepad_plus_plus

Install notepad++ on windows

### r_profile::windows::nsclient

Configure the NSClient++ software on Windows

#### Examples

##### Basic usage

```puppet
include r_profile::windows::nsclient
```

##### Change settings in nsclient.ini

```puppet
r_proflie::windows::nsclient::settings:
  "/settings/NRPE/server":
    ssl:
      value: "true"
    insecure:
      value: "false"
    "verify mode":
      ensure: absent
```

#### Parameters

The following parameters are available in the `r_profile::windows::nsclient` class.

##### `config_file`

Data type: `String`

Location of nsclient.ini

Default value: 'C:\Program Files\NSClient++\nsclient.ini'

##### `service`

Data type: `String`

Name of the windows service for nsclient

Default value: "nscp"

##### `settings`

Data type: `Hash[String, Hash[String, Hash[String, String]]]`

Hash of settings (see example)

Default value: {}

### r_profile::windows::ntp

If your planning on joining a domain you don't need this however there are a
few cases where windows boxes do not join domains (cloud, dmz, etc). In
these cases, this profile provides an easy way to set the correct time.

* **See also**
https://forge.puppet.com/geoffwilliams/windows_ntp

#### Examples

##### usage

```puppet
include r_profile::windows::ntp
```

##### Hiera data to use a corporate NTP server

```puppet
r_profile::windows::ntp::server: "ntp.megacorp.com"
```

#### Parameters

The following parameters are available in the `r_profile::windows::ntp` class.

##### `server`

Data type: `Optional[String]`

NTP server to use. If not specified, defaults to the module's selection
(`pool.ntp.org`)

Default value: `undef`

### r_profile::windows::powershell

Does nothing

### r_profile::windows::proxy

Set the windows system proxy using netsh

* **See also**
https://forge.puppet.com/sathieu/winhttp_proxy/readme

#### Examples

##### hiera data enabling proxy

```puppet
r_profile::windows::proxy::proxy_server: 'http=proxy.example.com;https=proxy.example.org'
r_profile::windows::proxy::exclusion: '<local>;*.example.org;*.example.com'
```

##### turning off proxy server

```puppet
r_profile::windows::proxy::ensure: absent
```

#### Parameters

The following parameters are available in the `r_profile::windows::proxy` class.

##### `ensure`

Data type: `Enum['present', 'absent']`

`present` to setup proxy, `absent` to remove configuration

Default value: present

##### `proxy_server`

Data type: `Optional[String]`

Proxy server to use in format for `netsh` see example

Default value: `undef`

##### `exclusion`

Data type: `Optional[String]`

Proxy exclusions in format for `netsh` see example

Default value: `undef`

### r_profile::windows::puppet_agent

Manages:
  * Puppet Agent service
  * Puppet binaries in `$PATH`
  * Proxy server environment variables (ruby uses these instead of the windows proxy information in registry)
  * Reboot after making any of the above changes in order to activate them

#### Parameters

The following parameters are available in the `r_profile::windows::puppet_agent` class.

##### `puppet_path`

Data type: `Variant[Boolean, String]`

Ensure this directory is in `$PATH` or pass `false` to do nothing

Default value: 'c:/Program Files/PuppetLabs/puppet/bin'

##### `proxy`

Data type: `Variant[Boolean, String]`

`false` Proxy server url to use with Puppet, eg `http://proxy.megacorp.com:8080`. Pass `false` to
deconfigure proxy support

Default value: `false`

##### `puppet_agent_service`

Data type: `String`

Name of the Puppet Agent service to manage

Default value: "puppet"

##### `puppet_agent_enable`

Data type: `Boolean`

`true` to start Puppet Agent on boot, otherwise `false`

Default value: `true`

##### `puppet_agent_ensure`

Data type: `Enum['running', 'stopped']`

How to ensure the Puppet Agent service

Default value: 'running'

##### `pxp_agent_service`

Data type: `String`

Name of the PXP Agent service to manage

Default value: "pxp-agent"

### r_profile::windows::registry

Manage Windows registry entries with Puppet

* **See also**
https://forge.puppet.com/puppetlabs/registry

#### Examples

##### hiera data

```puppet
r_profile::windows::registry::base_registry_key:
  'HKLM\System\CurrentControlSet\Services\Puppet':
r_profile::windows::registry::base_registry_value:
  'HKLM\System\CurrentControlSet\Services\Puppet\Description':
    type: string
    data: "The Puppet Agent service periodically manages your configuration"
r_profile::windows::registry::registry_key:
  'HKLM\System\CurrentControlSet\Services\Nagios':
r_profile::windows::registry::registry_value:
  'HKLM\System\CurrentControlSet\Services\Nagios\Description':
    type: string
    data: "Nagios service periodically monitors your computer"
```

#### Parameters

The following parameters are available in the `r_profile::windows::registry` class.

##### `base_registry_key`

Data type: `Hash[String, Optional[Hash]]`

Hash of registry keys to create (see example)

Default value: {}

##### `base_registry_value`

Data type: `Hash[String, Optional[Hash]]`

Hash of registry values to create (see example)

Default value: {}

##### `registry_key`

Data type: `Hash[String, Optional[Hash]]`

Hash of registry keys to create (see example)

Default value: {}

##### `registry_value`

Data type: `Hash[String, Optional[Hash]]`

Hash of registry values to create (see example)

Default value: {}

### r_profile::windows::rename_administrator

Rename the `administrator` account.

#### Examples

##### basic usage

```puppet
include r_profile::windows::rename_administrator
```

##### specifying the account to rename to

```puppet
r_profile::windows::rename_administrator::admin_account: "siteadmin"
```

#### Parameters

The following parameters are available in the `r_profile::windows::rename_administrator` class.

##### `account`

Data type: `Optional[String]`

New name for the `administrator` account. You must configure this
or no action will be taken

Default value: `undef`

### r_profile::windows::windows_feature

Rebooting is controlled adding an additional parameter `reboot_after` to the data fed
to this profile. _This_ class will act on this directive itself by subscribing its own
`reboot` resource to any windows features decorated with this parameter.

We will remove the `reboot_after` attribute from the hash of options passed to the real
`windows_feature` resource to prevent an error about unknown parameters.

Items to create are grouped into base and non-base to allow easy management in Hiera. Items in non-base can override
those in base.

* **See also**
https://forge.puppet.com/puppet/windowsfeature
https://forge.puppet.com/puppetlabs/reboot

#### Examples

##### basic usage

```puppet
include r_profile::windows::windows_feature
```

##### Hiera data to install windows features

```puppet
r_profile::windows::windows_feature::features:
  'Web-Server':
  'Web-WebServer':
    installmanagementtools: true
    reboot_after: true
```

#### Parameters

The following parameters are available in the `r_profile::windows::windows_feature` class.

##### `base_features`

Data type: `Hash[String, Optional[Hash]]`

Hash of windows features to install (base)

Default value: {}

##### `features`

Data type: `Hash[String, Optional[Hash]]`

Hash of windows features to install (override)

Default value: {}

## Functions

### r_profile::list_agent_platforms

Type: Ruby 4.x API

The r_profile::list_agent_platforms function.

#### `r_profile::list_agent_platforms()`

The r_profile::list_agent_platforms function.

Returns: `Any` Array of agent platforms for this PE version

